<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Sample illustrating the use of Web NFC.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Web NFC Sample</title>
</head>

<body>

    <h1>Web NFC Sample</h1>
    <p class="availability">
        Available in <a target="_blank" href="https://www.chromestatus.com/feature/6261030015467520">Chrome 89+</a> |
        <a target="_blank" href="https://github.com/googlechrome/samples/blob/gh-pages/web-nfc/">View on GitHub</a> |
        <a target="_blank" href="https://www.chromestatus.com/samples">Browse Samples</a>
    </p>
    <h3>Background</h3>
    <p>
        Web NFC aims to provide sites the ability to read and write to NFC tags when
        they are brought in close proximity to the userâ€™s device (usually 5-10 cm, 2-4
        inches). The current scope is limited to NDEF, a lightweight binary message
        format. Low-level I/O operations (e.g. ISO-DEP, NFC-A/B, NFC-F) and Host-based
        Card Emulation (HCE) are not supported within the current scope.
    </p>

    <button id="scanButton">Scan</button>
    <button id="writeButton">Write</button>
    <button id="makeReadOnlyButton">Make Read-Only</button>

    <script>
        var ChromeSamples = {
            log: function () {
                var line = Array.prototype.slice.call(arguments).map(function (argument) {
                    return typeof argument === 'string' ? argument : JSON.stringify(argument);
                }).join(' ');

                document.querySelector('#log').textContent += line + '\n';
            },

            clearLog: function () {
                document.querySelector('#log').textContent = '';
            },

            setStatus: function (status) {
                document.querySelector('#status').textContent = status;
            },

            setContent: function (newContent) {
                var content = document.querySelector('#content');
                while (content.hasChildNodes()) {
                    content.removeChild(content.lastChild);
                }
                content.appendChild(newContent);
            }
        };
    </script>

    <h3>Live Output</h3>
    <div id="output" class="output">
        <div id="content"></div>
        <div id="status"></div>
        <pre id="log"></pre>
    </div>

    <script>
        log = ChromeSamples.log;

        if (!("NDEFReader" in window))
            ChromeSamples.setStatus("Web NFC is not available. Use Chrome on Android.");
    </script>




    <script>

        scanButton.addEventListener("click", async () => {
            log("User clicked scan button");

            try {
                const ndef = new NDEFReader();
                await ndef.scan();
                log("> Scan started");

                ndef.addEventListener("readingerror", () => {
                    log("Argh! Cannot read data from the NFC tag. Try another one?");
                });

                ndef.addEventListener("reading", ({ message, serialNumber }) => {
                    log(`> Serial Number: ${serialNumber}`);
                    log(`> Records: (${message.records.length})`);
                });
            } catch (error) {
                log("Argh! " + error);
            }
        });
    </script>
</body>

</html>